# ğŸŒ± Crop Disease Prediction System (Machine Learning)

This repository contains a **professional, end-to-end Crop Disease Prediction system** built using **Deep Learning (EfficientNet)** and **Flask**. The project goes beyond basic model training and demonstrates a **production-style ML pipeline** including preprocessing, training, inference, and a web-based user interface.

The system is designed to:

* Train a robust crop disease classification model
* Handle real-world image uploads
* Provide **confidence-aware predictions**
* Display **disease remedies and precautions**

This project is suitable for **academic submissions, interviews, and applied ML portfolios**.

---

## ğŸ“‚ Project Structure Overview

```
crop_disease_system/
â”‚
â”œâ”€â”€ config.py                   # Central configuration (image size, paths, thresholds)
â”œâ”€â”€ requirements.txt            # Project dependencies
â”‚
â”œâ”€â”€ data/                       # Dataset storage
â”‚   â”œâ”€â”€ raw/                    # Original dataset (PlantVillage + Background_Noise)
â”‚   â”œâ”€â”€ train/                  # Auto-generated training data
â”‚   â””â”€â”€ val/                    # Auto-generated validation data
â”‚
â”œâ”€â”€ models/                     # Trained models & knowledge base
â”‚   â”œâ”€â”€ efficientnet_best.h5    # Best trained model (saved automatically)
â”‚   â”œâ”€â”€ class_indices.json      # Class ID â†’ Disease name mapping
â”‚   â””â”€â”€ disease_info.json       # Disease remedies & precautions
â”‚
â”œâ”€â”€ src/                        # Core ML logic
â”‚   â”œâ”€â”€ preprocess.py           # Dataset splitting & preprocessing
â”‚   â”œâ”€â”€ model_builder.py        # EfficientNet architecture definition
â”‚   â”œâ”€â”€ train_advanced.py       # Advanced training pipeline
â”‚   â””â”€â”€ inference_pipeline.py   # Robust prediction logic (TTA + safety checks)
â”‚
â””â”€â”€ web/                        # Web application
    â”œâ”€â”€ app.py                  # Flask backend
    â”œâ”€â”€ static/
    â”‚   â””â”€â”€ uploads/            # Temporary user uploads
    â””â”€â”€ templates/
        â”œâ”€â”€ index.html          # Upload page
        â””â”€â”€ result.html         # Prediction & remedy report
```

---

## ğŸš€ Getting Started

Follow the steps below **exactly in VS Code using a new terminal**.

---

## ğŸ”§ Installation & Setup

### 1ï¸âƒ£ Clone the Repository

```bash
git clone https://github.com/Javagar-S/crop-disease-prediction-ml.git
cd crop-disease-prediction-ml
```

---

### 2ï¸âƒ£ Create and Activate Virtual Environment

#### ğŸªŸ Windows

```bash
python -m venv crop
crop\Scripts\activate
```

#### ğŸ§ Linux / ğŸ macOS

```bash
python3 -m venv crop
source crop/bin/activate
```

---

### 3ï¸âƒ£ Install Required Dependencies

```bash
pip install -r requirements.txt
```

---

## ğŸ“Š Dataset Preparation

1. Place your dataset inside:

   ```
   data/raw/
   ```

   (Each disease must be in its own folder)

2. Run the preprocessing script **once**:

```bash
python src/preprocess.py
```

This will automatically:

* Shuffle the dataset
* Split it into training and validation sets
* Create `data/train/` and `data/val/`

---

## ğŸ§  Model Training

Train the model using the advanced training pipeline:

```bash
python src/train_advanced.py
```

### âœ” Training Features

* EfficientNet backbone
* Class weighting for imbalance
* Validation-based checkpoint saving
* Automatic best-model selection

The best model will be saved to:

```
models/efficientnet_best.h5
```

> âš ï¸ Training on CPU is slow. For faster results, Google Colab with GPU is recommended.

---

## ğŸŒ Run the Web Application

Once training is complete (or if a trained model already exists), start the Flask app:

```bash
python web/app.py
```

Then open your browser and go to:

```
http://127.0.0.1:5000/
```

---

## ğŸ§ª How Prediction Works (Behind the Scenes)

* Uploaded images are validated and resized
* Test-Time Augmentation (TTA) is applied
* Model confidence is checked against a threshold
* Disease information is fetched from `disease_info.json`
* Results are displayed with confidence and remedies

---

## ğŸ“Œ Configuration

All important settings are controlled from:

```
config.py
```

You can change:

* Image size
* Confidence threshold
* Dataset paths
* Model paths

No other file needs manual modification.

---

## ğŸ¯ Project Highlights

* End-to-end ML pipeline
* Real-world inference safeguards
* Clean modular architecture
* Interview-ready ML project
* Extendable to more crops and diseases

---

## ğŸ“ˆ Future Improvements

* GPU-based training
* Multi-crop support
* REST API deployment
* Mobile-friendly frontend
* Model explainability (Grad-CAM)

---

## ğŸ‘¤ Author

**Javagar.S**
Machine Learning | Data Science | AI Systems

---

âœ… This project demonstrates **applied machine learning**, not just model training.
